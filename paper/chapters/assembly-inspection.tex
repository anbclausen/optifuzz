\label{sec:inspection}

The next step in the OptiFuzz pipeline is assembly inspection.
The assembly inspection module is written in Python and works by inspecting the assembly generated by the compiler across different optimization flags.
The compiled assembly is inspected for conditional branching instructions and flagged if that is the case.
The assembly inspection module is only able to analyze x86-64 assembly.

In x86-64 assembly, \texttt{Jcc} (note, this does not include \texttt{JMP}), \texttt{LOOP} and \texttt{LOOPcc} are the only conditional branching instructions \citep{intel-reference}.
This means that the assembly inspection module only needs to look for these instructions.
Both \texttt{Jcc} and \texttt{LOOPcc} refer to families of instructions where \texttt{cc} is a condition code.
For example, \texttt{JE} (jump if equal) is in the \texttt{Jcc} instruction family. 
We did not include conditional move instructions in the analysis since they are constant-time \citep{cmov-is-constant-time}.

\subsubsection{Limitations}
An obvious limitation of this approach is that it is tailored for x86-64 assembly.
Hence our analysis will not work for other architectures.
Furthermore, the programs that are flagged by the assembly inspection module are not necessarily vulnerable to timing attacks.
Hence, the assembly inspection module overapproximates the set of programs that are vulnerable to timing attacks.
For example, the program in Figure \ref{fig:assembly-inspection-example} is flagged by the assembly inspection module, but it is constant-time since both branches take the same amount of time to execute.

\begin{figure}[]
  \centering
  \begin{lstlisting}[style=defstyle, language={[x86masm]Assembler}, basicstyle=\footnotesize\ttfamily,breaklines=true, xleftmargin=4cm, xrightmargin=4cm]
...
  cmpl    $1, -4(%rbp) ; compare TOS to 1
  je      .L2          ; jump to .L2 if equal
  movl    $43, %eax    ; move 43 into %eax
  jmp     .L3
.L2:
  movl    $0, %eax     ; move 0 into %eax
.L3:
  ret\end{lstlisting}
  \caption{Example of a program that is flagged by the assembly inspection module, but is constant-time.}
  \label{fig:assembly-inspection-example}
\end{figure}